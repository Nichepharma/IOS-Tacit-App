////  CreateViewWithArray.m//  Career Management Apps////  Created by Yahia on 3/20/16.//  Copyright Â© 2016 Nichepharma.com. All rights reserved.//#import "CreateViewWithArray.h"#import "Image.h"#import "SetAnimationsWithItems.h"#import "ApplicationData.h"@implementation CreateViewWithArray    NSMutableDictionary *actionImageDic ; // if image in json have action will pushing  data under action on this dic    AVAudioPlayer *myplayer;-(id)initWithArray :(NSMutableDictionary *)arr_contaner setXView :(float)vX {    self = [super initWithFrame:CGRectMake(vX, 0, 1024, 768)];    actionImageDic = [[NSMutableDictionary alloc] init];    if (self) {        // check if slide have mp3 file should play        if ( [arr_contaner objectForKey:@"sound"]) [self playMp3File:[arr_contaner objectForKey:@"sound"] ] ;        [self setViewContent:[arr_contaner objectForKey:@"image"] ];    }    return self;} -(void)setViewContent :(NSDictionary *)content_Dic{     for (   NSDictionary * elemenet in content_Dic ) {        float imgX = [[elemenet objectForKey:@"positionX"] floatValue];        float imgY = [[elemenet objectForKey:@"positionY"] floatValue];         UIImage *i2 = [Image loadimageFromDocumentWithName: [elemenet objectForKey:@"name"]                           stringWithApplicationDidSelected: [[ApplicationData getSharedInstance] getAppName]];         UIImageView *img = [[UIImageView alloc] initWithFrame:CGRectMake(imgX, imgY , i2.size.width, i2.size.height)];         [img setImage:i2];         NSString *isHaveAction = [elemenet objectForKey:@"haveAction"];         if (isHaveAction){             NSString *imageTag = [elemenet objectForKey:@"tag"] ;             [actionImageDic setObject: isHaveAction  forKey:imageTag];             [img setUserInteractionEnabled:YES];             UITapGestureRecognizer *singleTap =  [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(imageAction:)];             img.tag = [imageTag integerValue] ;             [singleTap setNumberOfTapsRequired:1];             [img addGestureRecognizer:singleTap];         }                  /*          setFrameset          setFrameWithPostion          setFadeAnimations          setDropeAnimations          setBarAnimations          setWidthAnimations          moveToY          moveToX          moveToX&Y          changeImage          */         NSString *str_AnimationType = [elemenet objectForKey:@"animationType"]  ;         float f_AnimationDelay = [[elemenet objectForKey:@"delay"]  floatValue] ;         if ([str_AnimationType isEqualToString:@"moveToY"] || [str_AnimationType isEqualToString:@"moveToX"] ) {             float f_nextMove =  [[elemenet objectForKey:@"nextMove"]  floatValue] ;             [SetAnimationsWithItems setAnimationsWithObjectMoveXorY:img                                                            withType:str_AnimationType                                                  animationWithDelay:f_AnimationDelay                                                         setNextMove:f_nextMove];         }else if ([str_AnimationType isEqualToString:@"moveToX&Y"] || [str_AnimationType isEqualToString:@"moveToX"] ) {             // Frame 1             float _X1 =  [[elemenet objectForKey:@"x1"]  floatValue] ;             float _Y1 =  [[elemenet objectForKey:@"y1"]  floatValue] ;             //Frame 2             float _X2 =  [[elemenet objectForKey:@"x2"]  floatValue] ;             float _Y2 =  [[elemenet objectForKey:@"y2"]  floatValue] ;             CGRect frame1 = CGRectMake(_X1 ,_Y1, img.frame.size.width, img.frame.size.height);             CGRect frame2 = CGRectMake(_X2 ,_Y2, img.frame.size.width, img.frame.size.height);             [SetAnimationsWithItems setFrameWithObject:img setFirstFrame:frame1 toSecondFrame:frame2 animationWithDelay:f_AnimationDelay];         }         else if ([str_AnimationType isEqualToString:@"setFrame"] ) {             // Frame 1             float _X1 =  [[elemenet objectForKey:@"x1"]  floatValue] ;             float _Y1 =  [[elemenet objectForKey:@"y1"]  floatValue] ;             float _W1 =  [[elemenet objectForKey:@"w1"]  floatValue] ;             float _H1 =  [[elemenet objectForKey:@"h1"]  floatValue] ;             //Frame 2             float _X2 =  [[elemenet objectForKey:@"x2"]  floatValue] ;             float _Y2 =  [[elemenet objectForKey:@"y2"]  floatValue] ;             float _W2 =  [[elemenet objectForKey:@"w2"]  floatValue] ;             float _H2 =  [[elemenet objectForKey:@"h2"]  floatValue] ;             NSLog(@"W1 = %f",_W1);             NSLog(@"H1 = %f",_H1);             NSLog(@"W2 = %f",_W2);             NSLog(@"H2 = %f",_W2);             CGRect frame1 = CGRectMake(_X1, _Y1, _W1, _H1);             CGRect frame2 = CGRectMake(_X2, _Y2, _W2, _H2);             [SetAnimationsWithItems setFrameWithObject:img                                        setFirstFrame:frame1                                        toSecondFrame:frame2                                        animationWithDelay:f_AnimationDelay];         }   else if ([str_AnimationType isEqualToString:@"setFrameWithPostion"] ) {             // Frame 1             float _X1 =  [[elemenet objectForKey:@"x1"]  floatValue] ;             float _Y1 =  [[elemenet objectForKey:@"y1"]  floatValue] ;             //Frame 2             float _X2 =  [[elemenet objectForKey:@"x2"]  floatValue] ;             float _Y2 =  [[elemenet objectForKey:@"y2"]  floatValue] ;             CGRect frame1 = CGRectMake(_X1, _Y1, img.frame.size.width, img.frame.size.height);             CGRect frame2 = CGRectMake(_X2, _Y2, img.frame.size.width,  img.frame.size.height);             [SetAnimationsWithItems setFrameWithObject:img setFirstFrame:frame1 toSecondFrame:frame2 animationWithDelay:f_AnimationDelay];         }         else if([str_AnimationType isEqualToString:@"changeImage"]){             UIImage *toNewImage = [Image loadimageFromDocumentWithName: [elemenet objectForKey:@"changeToImage"]                                       stringWithApplicationDidSelected: [[ApplicationData getSharedInstance] getAppName]] ;             NSLog(@"toNewImagetoNewImage %@ ", toNewImage) ;           [SetAnimationsWithItems setAnimationsWithObjectChangeImages:img toNewImage:toNewImage withDelay:f_AnimationDelay];             [self addSubview:img];         }         else {             [SetAnimationsWithItems setAnimationsWithObject:img   withType:str_AnimationType animationWithDelay:f_AnimationDelay];         }                           [self addSubview:img];                       } }-(IBAction)imageAction:(id)sender{    UIGestureRecognizer *recognizer = (UIGestureRecognizer*) sender;    int tag = recognizer.view.tag;    [self setViewContent: actionImageDic[[NSString stringWithFormat: @"%d", tag ] ]];}-(void)playMp3File :(NSString *) mp3File_name {    if (myplayer.isPlaying){        [myplayer stop];    }    NSString *str = [NSString stringWithFormat:@"%@/%@", [[ApplicationData getSharedInstance] getAppName] , mp3File_name ];    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);    NSString *documentsDirectory = [paths objectAtIndex:0];    NSString *soundFile=[documentsDirectory stringByAppendingPathComponent:[NSString stringWithString:str]];        NSLog(@"key %@ ", soundFile);    if (soundFile) {        NSURL *soundFileURL = [NSURL fileURLWithPath:soundFile];    if ([[NSFileManager defaultManager] fileExistsAtPath:soundFile]) {        NSError        *error;        myplayer = [[AVAudioPlayer alloc] initWithContentsOfURL:soundFileURL error:&error];//        [myplayer setDelegate:self];        // [self.myplayer setDelegate:self];        //[myplayer prepareToPlay];        // Play the sound once (set negative to loop)        [myplayer setNumberOfLoops:0];        [myplayer play];    }            }}@end